# PHP 命令与 Composer 使用笔记

## PHP 命令

### php --version

查看 PHP 解释器版本

### php -i

查看 PHP 的配置信息（类似于 phpinfo() 函数的命令行版本）

### php -S

启动内置服务器

```sh
php -S localhost:3000
```

### php -a

启动交互式 shell 模式（REPL）

### php -r

直接执行 PHP 代码

```sh
php -r "echo 'Hello World';"
```

### php -f

执行指定的 PHP 文件

```sh
php -f script.php
```

### php -l

检查 PHP 脚本语法

```sh
php -l filename.php
```

## Composer 命令

Composer 是一个专为 PHP 开发的依赖包管理工具，灵感来自 Node.js 的 [npm](https://github.com/npm/cli)

### 安装 Composer

#### Linux/macOS

```sh
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php -r "if (hash_file('sha384', 'composer-setup.php') === 'e21205b207c3ff031906575712edab6f13eb0b361f2085f1f1237b7126d785e826a450292b6c280543df02d3bea23') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"
php composer-setup.php
php -r "unlink('composer-setup.php');"
mv composer.phar /usr/local/bin/composer
```

#### Windows

- 下载并运行 [Composer-Setup.exe](https://getcomposer.org/Composer-Setup.exe)

```sh
# 验证安装:
composer --version
```

### 创建项目

#### 创建 ThinkPHP 项目

```sh
composer create-project topthink/think 项目名称
# 例如
composer create-project topthink/think myproject
```

#### 创建 Laravel 项目

```sh
# 方法1: 使用composer直接创建
composer create-project laravel/laravel 项目名称
# 例如
composer create-project laravel/laravel blog

# 方法2: 使用Laravel安装器(需先安装)
composer global require laravel/installer
laravel new 项目名称
```

### 安装依赖

#### 初始化新项目

```sh
composer init  # 交互式创建composer.json
```

#### 安装所有依赖

```sh
composer install  # 从composer.json和composer.lock安装依赖
```

#### 添加新依赖

```sh
composer require 包名  # 安装并添加到composer.json
# 例如
composer require monolog/monolog
```

#### 指定版本安装

```sh
composer require 包名:版本
# 例如
composer require monolog/monolog:^2.0
```

### 查看依赖信息

#### 列出所有已安装包

```sh
composer show
```

#### 查看特定包信息

```sh
composer show 包名
# 例如
composer show monolog/monolog
```

#### 搜索包

```sh
composer search 关键词
# 例如
composer search log
```

#### 检查依赖关系

```sh
composer depends 包名  # 查看哪些包依赖指定的包
composer prohibits 包名  # 查看为什么不能安装特定包
```

### 更新依赖

#### 更新所有依赖

```sh
composer update  # 更新所有包到最新版本
```

#### 更新特定包

```sh
composer update 包名
# 例如
composer update monolog/monolog
```

#### 更新特定组的包

```sh
composer update 包名1 包名2
```

#### 模拟更新

```sh
composer update --dry-run  # 仅显示将要更新的内容，不实际更新
```

### 移除依赖

```sh
composer remove 包名
# 例如
composer remove monolog/monolog
```

### 其他常用命令

#### 优化自动加载

```sh
composer dump-autoload -o  # 优化自动加载性能
```

#### 清除缓存

```sh
composer clear-cache  # 清除composer缓存
```

#### 验证composer.json

```sh
composer validate  # 验证composer.json文件是否有效
```

#### 查看依赖更新

```sh
composer outdated  # 查看已过期的依赖
```

#### 设置镜像源

```sh
# 使用国内镜像(如阿里云)
composer config repo.packagist composer https://mirrors.aliyun.com/composer/
```

#### 全局安装包

```sh
composer global require 包名  # 全局安装包
```
